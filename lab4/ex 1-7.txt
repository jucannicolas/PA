#include <stdio.h>
#include <stdlib.h>
typedef struct node
{
    int id;
    struct node *left,*right;
}NodeT;
NodeT *createBinTreeFromFile(FILE *pf) ///ex1
{
    int id;
    fscanf(pf,"%d",&id);
    if(id==0)
        return NULL;
    NodeT *p=(NodeT*)calloc(1,sizeof(NodeT));
    if(p==NULL)
    {
        perror("Problema la alocare");
        exit(1);
    }
    p->id=id;
    p->left=createBinTreeFromFile(pf);
    p->right=createBinTreeFromFile(pf);
    return p;
}
void preorder(NodeT *p) ///ex2
{
    if(p!=NULL)
    {
       printf("%d ",p->id);
        preorder(p->left);
        preorder(p->right);
    }

}
void inorder(NodeT *p)
{
    if(p!=NULL)
    {
        inorder(p->left);
        printf("%d ",p->id);
        inorder(p->right);
    }
}
void postorder(NodeT *p)
{
    if(p!=NULL)
    {
        postorder(p->left);
        postorder(p->right);
        printf("%d ",p->id);
    }
}
int leaf_node(NodeT *p) ///ex3
{
    if(p==NULL) return 0;
    if(p->right==NULL && p->left==NULL)
    {
        printf("%d ",p->id);
        return 1;
    }
    return leaf_node(p->left)+leaf_node(p->right);
}
int intern_node(NodeT *p) ///ex4
{
    if(p==NULL) return 0;
    if(p->right==NULL && p->left==NULL) return 0;
    printf("%d ",p->id);
    return intern_node(p->left)+intern_node(p->right)+1;
}
int maxim(int a,int b)
{
    if(a>b) return a;
    return b;
}
int inaltime_arbore(NodeT *p) ///ex5
{
    if(p==NULL) return -1;
    return 1+maxim(inaltime_arbore(p->left),inaltime_arbore(p->right));
}
NodeT *search(NodeT *root,int key) ///ex6
{
    if(root==NULL) return NULL;
    if(root->id==key) return root;
    NodeT *p=search(root->left,key);
    if(p!=NULL) return p;
    p=search(root->right,key);
    if(p!=NULL) return p;
    return NULL;
}
NodeT *createBalBinTree(int nbOfNodes)///ex7
{
    if(nbOfNodes<=0) return NULL;
    NodeT *p=(NodeT*)calloc(1,sizeof(NodeT));
    if(p==NULL)
    {
        perror("Problema la alocare");
        exit(1);
    }
    int nbLeft,nbRight;
    nbLeft=nbOfNodes/2;
    nbRight=nbOfNodes-1-nbRight;
    scanf("%d",&p->id);
    p->left=createBalBinTree(nbLeft);
    p->right=createBalBinTree(nbRight);
    return p;
}
int main()
{
    NodeT *root;
    FILE *pf=fopen("ArboreBinar.txt","r");
    if(pf==NULL)
    {
        printf("Nu s-a putut deschide fisierul\n");
        return -1;
    }
    root=createBinTreeFromFile(pf);
    /*preorder(root);
    printf("\n");
    inorder(root);
    printf("\n");
    postorder(root);
    printf("\n");*/
    int nr_frunze=leaf_node(root);
    printf("\nNumarul frunzelor este:%d\n",nr_frunze);
    int nr_noduri_interne=intern_node(root);
    printf("\nNumarul nodurilor interne este:%d\n",nr_noduri_interne);
    printf("Inaltimea arborelui este:%d\n",inaltime_arbore(root));
    NodeT* p=search(root,9);
    if(p==NULL) printf("Nu s-a gasit nodul");
    else printf("S-a gasit nodul cu cheia %d si are inaltimea %d\n",p->id,inaltime_arbore(p));
    fclose(pf);
    return 0;
}
