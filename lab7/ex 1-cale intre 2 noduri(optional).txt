#include <stdio.h>
#include <stdlib.h>
typedef struct node
{
    int key;
    struct node* next;
} NodeT;
typedef struct
{
    NodeT *tail,*head;
} Coada;
typedef struct
{
    int n;
    int **m;
} Graf;
void afisare_mat(int **a,int n)
{
    int i,j;
    for(i=0; i<n; i++,printf("\n"))
        for(j=0; j<n; j++)
            printf("%d ",a[i][j]);
}
void citire_graf(Graf *g,FILE *pf)
{
    int i;
    fscanf(pf,"%d",&(g->n));
    g->m=(int **)calloc(g->n,sizeof(int*));
    int **mat=g->m;
    for(i=0; i<g->n; i++)
        mat[i]=(int*)calloc(g->n,sizeof(int));
    int v,u;
    while(fscanf(pf," (%d,%d)",&v,&u)==2)
    {
        if(u<g->n && v<g->n)
            mat[v][u]=mat[u][v]=1;
    }
}

void elibereaza_memorie(int **a,int n)
{
    int i=0;
    for(i=0; i<n; i++)
        free(a[i]);
    free(a);
}
void Marshall(int **a,int n)
{
    int i,j,k;
    for(k=0; k<n; k++)
        for(i=0; i<n; i++)
            for(j=0; j<n; j++)
                if(a[i][k]==1 && a[k][j]==1) a[i][j]=1;

}
int verifica_conexiune(Graf g,int x,int y)
{
    if(x>=g.n || y>=g.n) return -1;
    if(g.m[x][y]==1) return 1;
    int n=g.n,i,j;
    int **matrice=(int **)calloc(n,sizeof(int *));
    for(i=0; i<n; i++)
        matrice[i]=(int*)calloc(n,sizeof(int));
    for(i=0; i<n; i++)
        for(j=0; j<n; j++)
            matrice[i][j]=g.m[i][j];
    Marshall(matrice,n);
    int rez=matrice[x][y];
    elibereaza_memorie(matrice,n);

    return rez;
}
int main()
{
    FILE *pf=fopen("date.txt","r");
    if(pf==NULL)
    {
        printf("Nu s-a putut deschide fisierul");
        return -1;
    }
    Graf g;
    citire_graf(&g,pf);
    //BFS(g,4);
    printf("%d",verifica_conexiune(g,4,1));
    elibereaza_memorie(g.m,g.n);
    return 0;
}
